[
  {
    "path": "posts/2022-02-18-binary-logistic-regression/",
    "title": "Binary Logistic Regression",
    "description": "Binary logistic regression to test feasibility of using variables plant height (height), canopy length (length), canopy width (width), and number of green leaves (green_lvs) to classify whether a palmetto is species Serenoa repens or Sabal etonia.",
    "author": [
      {
        "name": "Sophia Leiker",
        "url": {}
      }
    ],
    "date": "2022-02-18",
    "categories": [],
    "contents": "\n\n\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)\n\nlibrary(tidyverse)\nlibrary(here)\nlibrary(janitor)\nlibrary(patchwork)\nlibrary(cowplot)\nlibrary(GGally)\nlibrary(broom)\nlibrary(jtools)\nlibrary(caret)\nlibrary(AICcmodavg)\nlibrary(ggbeeswarm)\nlibrary(stargazer)\nlibrary(kableExtra)\nlibrary(modelsummary)\n\n\n\n1. Introduction\nThis report will employ binary logistic regression to test feasibility of using variables plant height (height), canopy length (length), canopy width (width), and number of green leaves (green_lvs) to classify whether a palmetto is species Serenoa repens or Sabal etonia.\nThe analysis will be performed twice, and will use cross validation to compare two models:\nLog odds of plant type using plant height, canopy length, canopy width and green leaves as predictor variable.\nLog odds of plant type using plant height, canopy width and green leaves (i.e., drop canopy length for this model)\nData Source: The data used comes from: Abrahamson, W.G. 2019. Survival, growth and biomass estimates of two dominant palmetto species of south-central Florida from 1981 - 2017, ongoing at 5-year intervals ver 1. Environmental Data Initiative and metadata, including methods used for data collection can be found here EDI Data Portal. The first dataset, palmetto_data, contains survival and growth data across multiple years, habitats and experimental treatments. The second dataset, seedlings_data, follows the fate of marked putative palmetto seedlings in the field to assess survivorship and growth. The final dataset, harvested_palmetto_data, contains size data and estimated dry mass (biomass in grams) of 33 destructively harvested palmetto plants (17 S. repens and 16 S. etonia) of varying sizes and across habitats.\n\n\n# Reading in the data\npalmetto <- read_csv(here(\"_posts\", \"2022-02-18-binary-logistic-regression\", \"data\", \"palmetto.csv\")) %>% \n  clean_names()\n\n\n\n2. Data Exploration and Visualization\nExploring differences in height, canopy length, canopy width, and green leaves for the two species\nheight = maximum height 1981-2017 [cm]\nlength = widest length of the canopy 1981-2017 [cm]\nwidth = widest width of the canopy perpendicular to the canopy length 1981-2017 [cm]\ngreen_lvs = count of green leaves 1981-2017 [dimensionless]\nAssessing what predictor variables might be best used for classification\nspecies column: 1 = Serenoa repens, 2 = Sabal etonia\nA. Cleaning up the data\nRename to easily identify Serenoa repens to Sabal etonia\nSelecting only the columns of interest\n\n\npalmetto_clean <- palmetto %>% \n  select(\"species\", \"height\", \"length\", \"width\", \"green_lvs\")\n\npalmetto_clean$species[palmetto_clean$species == 1] <- \"repens\"\npalmetto_clean$species[palmetto_clean$species == 2] <- \"etonia\"\n\n\n\n\n\n#Evaluating via ggpairs, eval = FALSE after visually assessing trends\npalmetto_clean %>% \n  select(species, height:green_lvs) %>% \n  ggpairs(aes(color=species))\n\n#seems like there are differences in green_lvs\n#slight difference in height and length\n#not much difference in width\n\n\n\nB. Visualizing the Data\nExploring differences in height, canopy length, canopy width, and green leaves for the two species\nWorking to determine which predictor variables are more likely to help classify species correctly\n\n\n#Plotting Width\nplot1 <- ggplot(data = palmetto_clean, aes(x = species, y = width)) +\n  geom_beeswarm(cex = 2, aes(color = species)) +\n  theme_minimal() +\n  labs(x = \"Species\", y = \"Width (cm)\", title = \"Canopy  Width S. repens, S. etonia\", subtitle = \"Data from: Abrahamson, W.G. 2019\") +\n  guides(fill = guide_legend(title = \"Species\")) +\n  geom_boxplot(fill = NA, width = 0.4, outlier.color = NA) +\n    theme(axis.ticks.x = element_blank(),\n        axis.text.x = element_blank()) +\n   scale_color_manual(values = c(\"steelblue1\", \"tan1\")) +\n  theme(legend.position = c(0.9, 0.75)) +\n    theme(legend.background = element_rect(fill=\"white\", \n                                  size=0, linetype=\"solid\"))\n\n#Plotting Height\nplot2 <- ggplot(data = palmetto_clean, aes(x = species, y = height)) +\n  geom_beeswarm(cex = 2, aes(color = species)) +\n  theme_minimal() +\n  labs(x = \"Species\", y = \"Canopy Height (cm)\", title = \"Canopy Height S. repens, S. etonia\", subtitle = \"Data from: Abrahamson, W.G. 2019\") +\n  guides(fill = guide_legend(title = \"Species\")) +\n  geom_boxplot(fill = NA, width = 0.4, outlier.color = NA) +\n    theme(axis.ticks.x = element_blank(),\n        axis.text.x = element_blank()) +\n   scale_color_manual(values = c(\"steelblue1\", \"tan1\")) +\n  theme(legend.position = c(0.9, 0.80)) +\n  theme(legend.background = element_rect(fill=\"white\", \n                                  size=0, linetype=\"solid\"))\n\n#Plotting Length\nplot3 <- ggplot(data = palmetto_clean, aes(x = species, y = length)) +\n  geom_beeswarm(cex = 2, aes(color = species)) +\n  theme_minimal() +\n  labs(x = \"Species\", y = \"Length (cm)\", title = \"Canopy Length S. repens, S. etonia\", subtitle = \"Data from: Abrahamson, W.G. 2019\") +\n  guides(fill = guide_legend(title = \"Species\")) +\n  geom_boxplot(fill = NA, width = 0.4, outlier.color = NA) +\n  theme(axis.ticks.x = element_blank(),\n        axis.text.x = element_blank()) +\n  scale_color_manual(values = c(\"steelblue1\", \"tan1\")) +\n  theme(legend.position = c(0.9, 0.82)) +\n  theme(legend.background = element_rect(fill=\"white\", \n                                  size=0, linetype=\"solid\"))\n\n\n\nVisualizing Individual Variables Between Species\nResults from this initial assessment will be used to plot final visualizations comparing variables to eachother by species (see Figures 2,3 and 4 for finalized assessments)\n\n\nplot_grid(plot1, plot2, plot3, labels = c(\"A.\", \"B.\", \"C.\"), label_size = 20)\n\n\n\nFigure 1: Spread of individual data points for the variables width, height, and length for Serenoa repend (orange) vs Sabtal etonia (blue). A) Illustrates canopy width as the widest width of the canopy perpendicular to the canopy length 1981-2017 [cm] between the two species, B) Illustrates maximum height 1981-2017 [cm] between the two species. C) Illustrates widest length of the canopy 1981-2017 [cm]. Green leaf spread is analyzed below.The box plots in black indicate the 25th and 75th percentile values of the data spread, the black line indicates the median value.\nTakeaways In general, there seems to be significant overlap in the spread of the width values across the dataset as seen in Figure 1 Part A. Canopy height in Figure 1 Part B illustrates that at the upper and lower ends of the height range, S. repends tends to stand out thus at these points there may be some power in incorporating this variable in analysis. Canopy length has similar trends to canopy width and thus with significant overlap may not provide as much explanatory power in differentiating the two species except at the higher values or when length is around 50cm - 100cm (at these points there seems to be more datapoints for the Serenoa repends (orange))\nVisualizing Variable Relationships (multiple variables)\n\n\nggplot(data = palmetto_clean, aes(x = length, y = width)) +\n  geom_point(aes(color = species)) +\n  theme_minimal() +\n  labs(x = \"Length (cm)\", y = \"Width (cm)\", title = \"Canopy Length and Width for Serenoa repens vs Sabal etonia\", subtitle = \"Data from: Abrahamson, W.G. 2019\") +\n  scale_color_manual(values = c(\"steelblue1\", \"tan1\"))\n\n\n\n\nFigure 2: Relationship between canopy length and canopy width for Serenoa repend (orange) vs Sabtal etonia (blue).\n\n\nggplot(data = palmetto_clean, aes(x = height, y = green_lvs)) +\n  geom_point(aes(color = species)) +\n  theme_minimal() +\n  labs(x = \"Height (cm)\", y = \"Green Leaves (count)\", title = \"Canopy Height and Green Leaves Count for Serenoa repens vs Sabal etonia\", subtitle = \"Data from: Abrahamson, W.G. 2019\") +\n  scale_color_manual(values = c(\"steelblue1\", \"tan1\"))\n\n\n\n\nFigure 3: Relationship between canopy height and green leaves for Serenoa repend (orange) vs Sabtal etonia (blue).\n\n\nggplot(data = palmetto_clean, aes(x = length, y = green_lvs)) +\n  geom_point(aes(color = species)) +\n  theme_minimal() +\n  labs(x = \"Length (cm)\", y = \"Green Leaves (count)\", title = \"Length and Green Leaves Count for Serenoa repens vs Sabal etonia\", subtitle = \"Data from: Abrahamson, W.G. 2019\") +\n  scale_color_manual(values = c(\"steelblue1\", \"tan1\"))\n\n\n\n\nFigure 4: Relationship between canopy length and green leaves for Serenoa repend (orange) vs Sabtal etonia (blue).\nOverall Takeaways: The variables that are most likely to help classify species seem to be first and most clearly, the leaf count, followed by height and then length, and lastly width. There seems to be significant overlap in canopy width which indicates that is may not be an ideal candidate to help separate out species. Canopy height and length differ on the upper end of the scale (higher values), but have significant overlap near lower values. Leaf count visually reflects the largest difference between the two species and thus could be the most likely to help classify Serenoa repend vs Sabtal etonia (blue) most clearly.\n3. Binary Logistic Regression\nConverting to factors\nEstablishing the factor levels, due to the result below it can be determined that “etonia” will be 0, “repens” will be 1\n\n\n#Converting to factor\n\npalmetto_clean2<- palmetto %>% \n  select(\"species\", \"height\", \"length\", \"width\", \"green_lvs\") %>% \n  mutate(species = case_when(species == 1 ~ \"repens\", species == 2 ~ \"etonia\")) %>% \n  mutate(species = as.factor(species)) %>% \n  drop_na()\n\n\nlevels(palmetto_clean2$species)\n\n\n[1] \"etonia\" \"repens\"\n\nA. Log odds of plant type using plant height, canopy length, canopy width and green leaves as predictor variables\n\n\n#establishing the relationships\nf1 <- species ~ height + length + width + green_lvs\n\n#Generalized Linear Model\n\nspecies_blr1 <- glm(formula = f1,\n                    data = palmetto_clean2,\n                    family = \"binomial\")\n\n\n\nLet’s look at the results\nBased on the summary output, all 4 of the variables have low p values which may indicate that they may be significant\nInterpretation of some coefficients: since green leaves is positive, we could estimate that for every 1.9 additional green leaves it makes it a little more likely that it is a repens.\n\n\n\n#species_blr1\n\nsummary(species_blr1) \n\n\n\nCall:\nglm(formula = f1, family = \"binomial\", data = palmetto_clean2)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-4.7828  -0.2681  -0.0054   0.1725   3.3964  \n\nCoefficients:\n             Estimate Std. Error z value Pr(>|z|)    \n(Intercept) -3.226685   0.142071  -22.71   <2e-16 ***\nheight       0.029217   0.002306   12.67   <2e-16 ***\nlength      -0.045823   0.001866  -24.56   <2e-16 ***\nwidth       -0.039443   0.002100  -18.78   <2e-16 ***\ngreen_lvs    1.908475   0.038863   49.11   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 17005.5  on 12266  degrees of freedom\nResidual deviance:  5184.6  on 12262  degrees of freedom\nAIC: 5194.6\n\nNumber of Fisher Scoring iterations: 7\n\nblr1_tidy <- broom::tidy(species_blr1)\n\n\n\nThese are coefficients for the log-linear model (e.g. these are coefficients for the predictor variables that relate to the log odds of the “Serenoa repend” outcome).\nIt took 7 iterations to reach this model outcome\nB. Log odds of plant type using plant height, canopy width and green leaves\n\n\nf2 <- species ~ height + width + green_lvs\n\n#Generalized Linear Model\n\nspecies_blr2 <- glm(formula = f2,\n                    data = palmetto_clean2,\n                    family = \"binomial\")\n\n\n\nLet’s look at the results\nBased on the summary output, width and green leaves have low p values which may indicate that they may be significant\nHeight has a higher p values which may indicate it is not as significant for this model\n\n\n\n#species_blr2\n\nsummary(species_blr2) \n\n\n\nCall:\nglm(formula = f2, family = \"binomial\", data = palmetto_clean2)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-4.7113  -0.3404  -0.0112   0.2167   3.4455  \n\nCoefficients:\n             Estimate Std. Error z value Pr(>|z|)    \n(Intercept) -3.767722   0.135314 -27.844   <2e-16 ***\nheight       0.002950   0.001881   1.568    0.117    \nwidth       -0.069019   0.001785 -38.661   <2e-16 ***\ngreen_lvs    1.884815   0.036127  52.172   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 17005.5  on 12266  degrees of freedom\nResidual deviance:  5979.5  on 12263  degrees of freedom\nAIC: 5987.5\n\nNumber of Fisher Scoring iterations: 7\n\nblr2_tidy <- broom::tidy(species_blr2)\n\n\n\n\n\nblr2_fitted <- species_blr2 %>% \n  broom::augment(type.predict = \"response\")\n\n\n\nC. Comparing Models using AICc\n\n\nAIC_assessment <- AICcmodavg::aictab(list(species_blr1, species_blr2))\n\n\n\nAICc for Model 1 (plant height, canopy length, canopy width and green leaves) is 5194.57\nAICc for Model 2 (plant height, canopy width and green leaves) is 5987.48\nAccording to this AICc calculation, Model 1 has a lower value for AICc so just based on the AICc, we might anticipate that model 1 will be the better model.\nD. Comparing Model 1 and Model 2 using Ten-fold cross validation\n\n\nset.seed(123) \ntr_ctrl <- trainControl(method = \"repeatedcv\", number = 10, repeats = 10)\n \n# Train the model\n#Formula f1, data frame, method is the generalized linear model\nmodel1_height_length_width_green_lvs <- train(f1, data = palmetto_clean2, \n               method = \"glm\", family = 'binomial',\n               trControl = tr_ctrl)\n#summary(model1_height_length_width_green_lvs)\n#model 1  accuracy 0.9169231  kappa 0.8338335\n \nmodel2_height_width_green_lvs <- train(f2, data = palmetto_clean2, \n               method = \"glm\", family = 'binomial',\n               trControl = tr_ctrl)\n#summary(model2_height_width_green_lvs)\n#model 2   accuracy 0.8988022  kappa 0.7975858\n\n#Since the accuracy of model 1 is higher, we may be able to state that model 1 is the better performing model\n\n\n\nTakeaways : Based on the accuracy results of the corss validation, Model 1 (height, length, width, green_lvs) has a higher accuracy than Model 2 (height, width, green_lvs) and therefore it can be said that model 1 performs better at classification. This aligns with the AICc assessment carried out above.\nFor this reason, Model 1 will be selected to run on the entire dataset.\n4. Running Model 1 (Variables included: height, length, width, green_lvs) on entire dataset\n\n\nfinal_model <- glm(formula = f1,\n                    data = palmetto_clean2,\n                    family = \"binomial\")\n\n\n\n\n\nfinal_table <- tidy(final_model) %>% \n  mutate(p.value = case_when(p.value <= 0.0001 ~ \"< 0.0001\")) %>% \n  rename(\"Term\" = \"term\")\n\nfinal_table %>% \n  kbl(digits = 3, caption = \"Table 1: Binary Logistic Regression Model Outputs Showing the Variables, Coefficients, Standard Errors\", col.names = c(\"Term\", \"Estimate\", \"Standard Error\", \"Statistic\", \"P Value\")) %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = F)\n\n\n\nTable 1: Table 1: Binary Logistic Regression Model Outputs Showing the Variables, Coefficients, Standard Errors\n\n\nTerm\n\n\nEstimate\n\n\nStandard Error\n\n\nStatistic\n\n\nP Value\n\n\n(Intercept)\n\n\n-3.227\n\n\n0.142\n\n\n-22.712\n\n\n< 0.0001\n\n\nheight\n\n\n0.029\n\n\n0.002\n\n\n12.670\n\n\n< 0.0001\n\n\nlength\n\n\n-0.046\n\n\n0.002\n\n\n-24.556\n\n\n< 0.0001\n\n\nwidth\n\n\n-0.039\n\n\n0.002\n\n\n-18.782\n\n\n< 0.0001\n\n\ngreen_lvs\n\n\n1.908\n\n\n0.039\n\n\n49.107\n\n\n< 0.0001\n\n\nFinal Model Equation: \\[\n\\begin{aligned}\n\\log\\left[ \\frac { \\widehat{P( \\operatorname{species} = \\operatorname{repens} )} }{ 1 - \\widehat{P( \\operatorname{species} = \\operatorname{repens} )} } \\right] &= -3.23 + 0.03(\\operatorname{height}) - 0.05(\\operatorname{length}) - 0.04(\\operatorname{width})\\ + \\\\\n&\\quad 1.91(\\operatorname{green\\_lvs})\n\\end{aligned}\n\\]\n5. Model Evaluation\nAnalyzing how successfully this model would “classify” a plant as the correct species, using a 50% cutoff\n\n\nblr_fitted <- final_model %>% \n  broom::augment(type.predict = \"response\")\n\n#That shows us the probability (in the `.fitted` column) of the plant being a Serenoa repend on the 4 variables included in this model.\n\n\n\n\n\n#creating a function\npred_acc <- function(x, y) {\n  accurate <- ifelse(x == y, 1, 0)\n  return(accurate)\n}\n\n#final_model Serenoa repend (orange) vs Sabtal etonia (blue)\n#Adelie will be 0, Chinstrap will be 1)\n#\"etonia\" will be 0, \"repens\" will be 1\n\nmodel_success <- palmetto_clean2 %>% \n  mutate(predict_repens = predict(final_model, palmetto_clean2, type = \"response\")) %>% \n  mutate(predicted = ifelse(predict_repens >= 0.50, \"repens\", \"etonia\")) %>%\n  mutate(accurate = pred_acc(species, predicted)) %>% \n  mutate(correct =  case_when(species == predicted ~ \"Correct\",\n                              TRUE ~ \"Incorrect\"))\n\ntable2 <- model_success %>%\n  group_by(species) %>% \n  summarize(total_accurate = sum(accurate),\n            total_inaccurate = n() - sum(accurate),\n            model_success = mean(accurate)*100)\n\ntable2 %>% \n  kbl(digits = 2, caption = \"Table 2: Model Accuracy by Species\", col.names = c(\"Species\", \"Total Accurate\", \"Total Inaccurate\", \"% Correctly Classified\")) %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = F)\n\n\n\nTable 2: Table 2: Model Accuracy by Species\n\n\nSpecies\n\n\nTotal Accurate\n\n\nTotal Inaccurate\n\n\n% Correctly Classified\n\n\netonia\n\n\n5701\n\n\n454\n\n\n92.62\n\n\nrepens\n\n\n5548\n\n\n564\n\n\n90.77\n\n\nCONCLUSIONS: Based on the model success metrics, one can see that on average the model was predicting correctly about 90% of the time. The model was slightly more accurate when predicting Sabtal etonia compared to Serenoa repend, but the difference was only around 2%.\n6. Data Citation\nData source: Abrahamson, W.G. 2019. Survival, growth and biomass estimates of two dominant palmetto species of south-central Florida from 1981 - 2017, ongoing at 5-year intervals ver 1. Environmental Data Initiative. https://doi.org/10.6073/pasta/f2f96ec76fbbd4b9db431c79a770c4d5\nEND TASK\n\n\n\n",
    "preview": "posts/2022-02-18-binary-logistic-regression/binary-logistic-regression_files/figure-html5/unnamed-chunk-5-1.png",
    "last_modified": "2022-02-18T17:28:02-08:00",
    "input_file": "binary-logistic-regression.knit.md"
  },
  {
    "path": "posts/2022-02-18-nonlinear-least-squares/",
    "title": "Nonlinear Least Squares",
    "description": "Emploing non linear least squares to estimate parameters of a length to weight model for lizard populations in New Mexico..",
    "author": [
      {
        "name": "Sophia Leiker",
        "url": {}
      }
    ],
    "date": "2022-02-18",
    "categories": [],
    "contents": "\n\n\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)\n\nlibrary(tidyverse)\nlibrary(here)\nlibrary(janitor)\nlibrary(lubridate)\nlibrary(patchwork)\nlibrary(cowplot)\nlibrary(broom)\nlibrary(jtools)\nlibrary(caret)\nlibrary(kableExtra)\nlibrary(modelr)\n\n\n\nIntroduction\nThis report will employ non linear least squares to estimate parameters of a length to weight model for lizard populations in New Mexico. To do this the snout length to weight model will be used.\nData Source: The data used comes from: Lightfoot, D. and W.G. Whitford. 2020. Lizard pitfall trap data from 11 NPP study locations at the Jornada Basin LTER site, 1989-2006 ver 37. Environmental Data Initiative. and metadata, including raw data and methods used for data collection can be found here EDI Data Portal.\nThis data package contains data on lizards sampled by pitfall traps located at 11 consumer plots at Jornada Basin LTER site from 1989-2006. Lizards were captured in pitfall traps at the 11 LTER II/III consumer plots (a subset of NPP plots) quarterly for 2 weeks per quarter. Variables measured include species, sex, recapture status, snout-vent length, total length, weight, and whether tail is broken or whole.\n\n\n# Reading in the data\npalmetto <- read_csv(here(\"_posts\",\"2022-02-18-nonlinear-least-squares\", \"data\", \"lizard.csv\")) %>% \n  clean_names() %>% \n  drop_na() \n  \n#palmetto naming convention was wrong, too far into the code to change when this was realized\n\n\n\n1. Fitting Snout Length to Weight Model\nEquation \\[W = a(SVL)^b\\]\nWhere W is the Body weight (g), SVL is snout to vent length (mm).\na and b are parameters which need to be fitted\nA. Log Transform of data & Running Guess Model\n\n\n# Since the my_guess_model has things in logs, need to log transform to create new columns\npalmetto_log <- palmetto %>% \n  mutate(log_weight = log(weight)) %>% \n  mutate(log_length = log(sv_length))\n\n\n\nRunning linear model\n\n\nmy_guess_model <- lm(log_weight ~ log_length, data = palmetto_log) \n\n\n\nB. Supplying NLS Start list with regression coefficients\nPulling out the coefficients from my_guess_model\nUsing coefficients function\n\n\n\ncoef <- coefficients(my_guess_model)\n\n#Cleaning up the model so I can pull out the coefficients easier  my_guess_model_clean <- tidy(my_guess_model) \n\n\n\nCoefficient Output\nThe intercept of my_guess_model is -8.475\nThe log_length of my_guess_model is 2.537\n\nCreating a function for the equation listed - Inputs are a, sv_length, b (a and b are coefficients)\n\n\nweight_function<-function(a,sv_length,b){\n weight= a*(sv_length)^b\nreturn(weight)\n}\n\n\n\n2. Final Model: Female and Male Spcies by Color\nUsing nls and feeding in our coefficients as a starting off point\n\n\npalmetto_nls <- nls(weight ~ weight_function(a,sv_length,b),\n                    data = palmetto,\n                    start = list(b = coef[2],\n                                 a = exp(coef[1])))\n\n#Cleaning up to create nice output\npalmetto_nls_tidy <- tidy(palmetto_nls)\n\n\n\n\n\n#Making a table with outputs\npalmetto_nls_tidy %>% mutate(p.value = case_when(p.value < 0.001 ~ \"<0.001\")) %>% \n  kable(col.names = c(\"Term\", \"Coefficient\", \"Standard Error\", \"Statistic\", \"P Value\"), digits = 4, caption = \"Table 1: NLS Model Results\") %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\")) %>% \n  kable_styling(full_width = FALSE)\n\n\n\nTable 1: Table 1: NLS Model Results\n\n\nTerm\n\n\nCoefficient\n\n\nStandard Error\n\n\nStatistic\n\n\nP Value\n\n\nb\n\n\n2.4532\n\n\n0.027\n\n\n90.9300\n\n\n<0.001\n\n\na\n\n\n0.0003\n\n\n0.000\n\n\n8.5384\n\n\n<0.001\n\n\n\n\n#augmenting predictions to the actual dataset \n\npalmetto_augment <- palmetto_nls %>% \n  broom::augment()\n\n\n\n\n\n#Plotting female and male lizards separated by color\npalmetto3 <- palmetto\n\npalmetto3$sex[palmetto3$sex == \"M\"] <- \"Male\"\npalmetto3$sex[palmetto3$sex == \"F\"] <- \"Female\"\n  \n\nggplot() +\n  geom_point(data = palmetto3, aes(x=sv_length, y = weight, color = sex)) +\n  labs(title = \"NLS Model Prediction Results for Snout to vent length (mm) vs Weight (g)\", \n       subtitle = \"Data From: Lightfoot, D. and W.G. Whitford. 2020\",\n       x = \"Snout to vent length (mm)\", y = \"Weight (g)\") +\n  theme_minimal() +\n  geom_line(data = palmetto_augment, aes(\n            x = sv_length,\n            y = .fitted,\n            color = \"Model Predictions\"),\n            size = 0.5) +\n  theme(legend.title = element_blank()) +\n  scale_color_manual(values = c(\"seagreen3\", \"mediumblue\", \"mediumvioletred\"))\n\n\n\n\nFigure 1: NLS Model Prediction Results for Snout to vent length (mm) vs Weight (g) with colors representing Male (M) and female (F) lizards. The points represent individual data points from the dataset, the purple line represents the model predictions.\n\n\n#Calculating RMSE\n\npalmetto_rmse <- rmse(palmetto_nls, data = palmetto)\n\n\n\nRMSE The RMSE for the NLS Model run on all the points is 2.791\n3. Filtering for male Western Whiptail lizard (Cnemidophorus tigrisatus)\nFiltering for variables of interest, transforming to log weight and sv_length\nFit NLS Model\n\n\nwhiptail <- palmetto %>% \n  filter(spp == \"CNTI\") %>% \n  filter(sex == \"M\") %>% \n  mutate(log_weight = log(weight)) %>% \n  mutate(log_length = log(sv_length)) %>% \n  drop_na()\n\n\n\nA. Running Linear Model\n\n\nwhiptail_model <- lm(log_weight ~ log_length, data = whiptail)\n\n\n\nB. Supplying NLS Start list with regression coefficients\nPulling out the coefficients from my_guess_model\nUsing coefficients function\n\n\n\ncoef_whiptail <- coefficients(whiptail_model)\n\n#Cleaning up the model so I can pull out the coefficients easier  whiptail_model_clean <- tidy(whiptail_model) \n\n\n\nCoefficient Output\nThe intercept of whiptail_model is -9.024\nThe log_length of whiptail_model is 2.698\nC. Final Model\nUsing nls and feeding in our coefficients as a starting off point\nUsing original whiptail dataset\n\n\nwhiptail_nls <- nls(weight ~ weight_function(a,sv_length,b),\n                    data = whiptail,\n                    start = list(b = coef_whiptail[2],\n                                 a = exp(coef_whiptail[1])))\n\n#Cleaning up to create nice output\nwhiptail_nls_tidy <- tidy(whiptail_nls)\n\n\n\n\n\n#Making a table with outputs\nwhiptail_nls_tidy %>%\n  kable(col.names = c(\"Term\", \"Coefficient\", \"Standard Error\", \"Statistic\", \"P Value\"), digits = 4, caption = \"Table 2: NLS Model Results\") %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\")) %>% \n  kable_styling(full_width = FALSE)\n\n\n\nTable 2: Table 2: NLS Model Results\n\n\nTerm\n\n\nCoefficient\n\n\nStandard Error\n\n\nStatistic\n\n\nP Value\n\n\nb\n\n\n2.3683\n\n\n0.1800\n\n\n13.1547\n\n\n0.0000\n\n\na\n\n\n0.0005\n\n\n0.0004\n\n\n1.2397\n\n\n0.2192\n\n\n\n\n#augmenting predictions to the actual dataset \n\nwhiptail_augment <- whiptail_nls %>% \n  broom::augment()\n\n\n\n\n\n#data.frame to combine palmetto_augment with the palmetto data set\nnew_dataframe <- data.frame(palmetto_augment, palmetto) %>% \n  filter(spp == \"CNTI\") %>% \n  filter(sex == \"M\")\n\n\n\n\n\n#Plotting female and male lizards separated by color\n\nggplot() +\n  geom_point(data = whiptail, aes(x=sv_length, y = weight)) +\n  labs(title = \"Male Whiptail NLS Model Predictionsfor Snout to vent length (mm) vs Weight (g)\", \n       subtitle = \"Data From: Lightfoot, D. and W.G. Whitford. 2020\",\n       x = \"Snout to vent length (mm)\", y = \"Weight (g)\") +\n  theme_minimal() +\n  geom_line(data = whiptail_augment, aes(\n            x = sv_length,\n            y = .fitted,\n            color = \"Male Whiptail Model Predictions\"),\n            size = 0.5) +\n  theme(legend.title = element_blank()) +\n  geom_line(data = new_dataframe, aes(\n            x = sv_length,\n            y = .fitted,\n            color = \"Full Dataset Model Predictions\"),\n            size = 0.5) +\n  scale_color_manual(values = c(\"mediumvioletred\", \"forestgreen\"))\n\n\n\n\n\n\n#Calculating RMSE\nwhiptail_rmse <- rmse(whiptail_nls, data = whiptail)\ntotal_rmse <- rmse(palmetto_nls, data = whiptail)\n\n\n\nFigure 2: Male Whiptail NLS Model Prediction Results for Snout to vent length (mm) vs Weight (g). The points represent individual data points from the dataset, the purple line represents the model predictions for weight based on the NLS run on the full dataset, the green line represents the model predictions based on the NLS model trained with just the Male Whiptails. The RMSE for the NLS model trained on the full dataset is 3.562. The RMSE for the NLS Model run on male whiptail points is 3.349. By comparing the RMSE values it can be seen that the RMSE higher for the NLS model trained on the full dataset, thus the model that should be used is the Male Whiptail Model (green line). Visually, this can also be seen in the model prediction lines as the green line seems to better capture the trends in the datapoints.\n4. Data Citation\nLightfoot, D. and W.G. Whitford. 2020. Lizard pitfall trap data from 11 NPP study locations at the Jornada Basin LTER site, 1989-2006 ver 37. Environmental Data Initiative. https://doi.org/10.6073/pasta/4a6e258fb49c31e222ecbbcfd128967f\nEND TASK\n\n\n\n",
    "preview": "posts/2022-02-18-nonlinear-least-squares/nonlinear-least-squares_files/figure-html5/unnamed-chunk-9-1.png",
    "last_modified": "2022-02-18T17:36:13-08:00",
    "input_file": "nonlinear-least-squares.knit.md"
  },
  {
    "path": "posts/2022-01-30-the-sharpe-ratio/",
    "title": "Remote Sensing and Biodversity Monitoring",
    "description": "This post will highlight the state of remote sensing as used for monitoring, reporting and verying biodiversity as an ecosystem health metric.",
    "author": [
      {
        "name": "Sophia Leiker",
        "url": {}
      }
    ],
    "date": "2022-01-30",
    "categories": [],
    "contents": "\nAdd some really cool info here\n\n\n\n",
    "preview": {},
    "last_modified": "2022-01-30T23:44:57-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-17-welcome/",
    "title": "Welcome!",
    "description": "Drop by to hear musing, thoughts and refelctions on my excitement as I explore topics related to remote sensing, ecosystem services, nature based solutions, Web3 and decentralized finance to fund ecological restoration.",
    "author": [
      {
        "name": "Sophia Leiker",
        "url": {}
      }
    ],
    "date": "2022-01-17",
    "categories": [],
    "contents": "\nWelcome to my site!\nStick around to hear musing\n\n\n\n",
    "preview": {},
    "last_modified": "2022-01-30T23:40:56-08:00",
    "input_file": {}
  }
]
