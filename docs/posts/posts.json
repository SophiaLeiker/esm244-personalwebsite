[
  {
    "path": "posts/2022-03-08-biochar-for-carbon-sequestration/",
    "title": "Biochar for Carbon Sequestration",
    "description": "The use of biochar for soil carbon sequesrtration and increased crop yields have gained increased attention. This report dives into the science of biochar and it's potential to increase overal carbon uptake and storage.",
    "author": [
      {
        "name": "Sophia Leiker",
        "url": {}
      }
    ],
    "date": "2022-03-08",
    "categories": [],
    "contents": "\nRegeneration International1. Introduction:\nBiochar increases carbon sequestration through a process of heating plant biomass without oxygen (also known as pyrolysis) to create a charcoal-like residue that can then be applied to agricultural lands increasing carbon uptake and storage while also improving soil fertility and water holding capacity (Verheijen et al., 2010). Increased attention has been directed towards the use of biochar due to its “low risk of rapid or large-scale leakage” (Lehmann, 2007). This means that carbon biochar is stored in a stable form, separating this technique from others which have high reversal risks from wildfires, tillage or biomass harvest. Biochar can improve carbon sequestration in two ways 1) reducing biomass CO2 emissions that otherwise would be released through decomposition or combustion, 2) providing a surface for soil carbon to be held in a more stable form, resistant to decay from soil microbes.\n2. How does it work: Altering the Carbon Cycle, Altering Soil Carbon\nTo create biochar, organic waste “such as wood chips, agricultural byproducts or switchgrass” (Levitan, 2010 ) is burned at temperatures 250−900 °C (Yaashikaa et al., 2020) in anaerobic or extremely low oxygen conditions (Figure 1, Figure 2). This alters the carbon cycle in that pyrolysis takes ~50% of the biomass carbon that would have otherwise been released as CO2 through combustion or decomposition (Lehmann et al., 2006), and turns it into more stable carbon structures that remain sequestered much longer (Njunge, 2012, Figure 3). Residence times for wood biochar range from “100s to 1,000s of years, which is approximately 10-1,000 times longer than residence times of most soil organic matter” (Verheijen et al., 2010). Additionally, biochar provides an opportunity for organic matter to adsorb to its surface. This shifts bioavailable “labile carbon” to “recalcitrant carbon” that is resistant to decay, preventing soil microbes from being able to consume this carbon. Due to this, there is an increase in overall soil carbon storage. The magnitude of impact biochar has on soil functions depends on factors such as “chemical composition, surface chemistry, particle/pore size distribution” (Verheijen et al., 2010), thus further study is needed for optimization.\n3. Cost for Application of Biochar\nStudies have shown that biochar should be applied at levels no higher than 10 tons per acre for field crops, and wood biochar costs around $350/ton (Bista et al., 2019). Cost for application varies, but generally falls above $8/ton with total application costs ranging from $2,900-$17,900 per acre depending on total mass of the biochar applied (Sorensen & Lamb, 2018). Each application can last up to 10 years depending on environmental conditions. Biochar as a negative emission technology has been listed at 0.5–2 Gt/CO2 yr−1 for sequestration potential with a cost of $30–120 per ton of CO2 sequestered (Fuss & Lamb, 2018).\n4. Advantages and Disadvantages\nAdvantages: The application of biochar can be integrated into current farming techniques (fertilizer or manure applications) at the local or field scale without the need for additional equipment (Lehmann, 2007). On top of influencing the carbon sequestration, biochar has also been shown to increase soil functioning and restore degraded soils, “biochar can improve the structure and fertility of soils, thereby improving biomass production… [it] enhances the retention and therefore efficiency of fertilizers” (Lehmann, 2007). Studies have also shown that biochar impacts other biogeochemical cycles such as increasing Nitrogen retention in soils (Steiner et al, 2008) which may help reduce impact of fertilizer runoff such as eutrophication. Biochar can also “moderate the pH, or acidity, of the soils” due to its alkalinity (Levitan, 2010) and can act to neutralize acid rain. Resource-wise, the advantage of biochar is that there is sufficient biomass to carry out this process, from timber residues (3.5 tonnes biomass per ha/year on 20 million ha), fast growing vegetation on idle cropland (20 tonnes biomass per ha/year on 30 million ha), and crop residues (5.5 tonnes biomass per ha/year for 120 million ha) (Lehmann, 2007). Finally, the technology to create and apply biochar is already mature and ready to be scaled up, lowering the barrier to immediate use. Disadvantages/Challenges: A major challenge is ensuring biochar is sustainably produced using a closed loop system. If leakage takes place during pyrolysis, the sequestration potential of applying biochar will be offset by the inputs needed to create it. An additional challenge is further understanding its long term sequestration potential “The precise duration of biochar’s storage time is under debate, with opinions ranging from millennial… to centennial timescales” (Lehmann, 2007). These ranges would significantly impact estimates around soil carbon potential. Finally, in some studies, it was shown that applying biochar actually increased CO2 emissions due to soil surface environmental disturbance factors with the application resulting in a net carbon source to the atmosphere rather than net carbon sink (Li et al., 2021). This question is crucial to determine where the application of biochar might result in a carbon source versus carbon sink. A final disadvantage is that soils have a carbon storage capacity that could be increasing with biochar applications, but only up to a saturation point where soils hit their maximum and cannot hold any more Carbon.\n5. Case Study: Biochar Facilitating Carbon Sequestration on the Loess Plateau\nIn North Central China a 16 month field experiment was carried out to assess the impact of biochar application in a dryland agricultural system (Li et al., 2021). Historically, the site implemented a corn/wheat system using tillage practices on a silt clay soil. Biochar derived from apple branches was applied at 3 different soil depths (0-10cm, 10-20cm, 0-20cm). Results revealed that the application of biochar inhibited microbial activity which “increased the SOC [soil organic carbon], C:N ratio and DOC in the 0–10 cm soil” (Li et al., 2021). The difference illustrated in Figure 4 shows that the control soil (no biochar) had a soil organic carbon value of 6.73 g/kg while the soil with biochar application (0-10cm) had a value of 13.13g/kg (Figure 4).\n6. Environmental Justice/Policy and Econ aspects\nThe benefits of biochar extend beyond the public good of carbon sequestration as increased soil water retention and a moderation of soil pH can increase crop yields. “Biochar also enriches soil, which improves food security in developing countries and crop production almost anywhere” (Levitan, 2010). These increased yield benefits can help farmers in lower income countries who may already be dealing with crop failure and thus food shortages. The benefits of biochar on water retention especially apply to regions which will face more frequent droughts due to changing precipitation patterns driven by climate change. In order for the benefits of biochar to extend beyond developed nations, equity in access to biochar resources must be considered as many who need it most, may not have the finances to purchase it.\n##7. Conclusion and Recommendations\nWith the earth’s soils containing about three times the amount of carbon in the atmosphere and four times the amount stored in living matter (Cho, 2018), biochar should be considered a small piece to a much larger puzzle of sequestration tools. Biochar stands out as a low risk strategy in relation to other sequestration options with the assurance that “Once biochar is incorporated into soil, it is difficult to imagine any incident or change in practice that would cause a sudden loss of stored carbon” (Lehmann, 2007). With increased crop yield due to heightened water retention and soil functioning, this solution can also support other sustainable development goals such as increasing food security. To encourage adoption, financial incentive structures must be in place to provide access to small landholders who may not have the capital up front to invest in biochar applications. One method to overcome this would be to connect small farmers with voluntary carbon markets to provide them the funding through carbon offset payouts. This would require standards to be created for monitoring, reporting, and verifying biochar and carbon sequestration metrics. Additionally, the need for sustainable biochar production is critical. If the process used to create the biochar is not up to certain standards, there is the potential for biochar to be carbon neutral or carbon positive rather than carbon negative. Finally, further studies are needed to understand how to optimize biochar application on a range of soil types, climate zones, and croplands to maximize its effect.\nFIGURES\nFigure 1: How biochar is made, its potential feedstocks and many uses Citation: Shiralian, M. (2016, June 14). Biochar offers many environmental benefits. Environmental Science & Engineering Magazine. Retrieved February 20, 2022, from https://esemag.com/hazmat-remediation/biochar/\nFigure 2: Creating Biochar\nCitation: Yaashikaa, P., Kumar, P., & Varjani, S. (2020). A critical review on the biochar production techniques, characterization, stability and applications for circular bioeconomy. Biotechnology Reports, 28(e00570), . ElSEVIER. https://doi.org/10.1016/j.btre.2020.e00570\nFigure 3: Carbon Cycle Vs Biochar Cycle\nCitation: Njunge, L. (2012). Enhancement Of Colonisation Of Soybean Roots By Arbuscular Mycorrhizal Fungi Using Vermicompost and Biochar. University of Nairobi, Reg Number: I575/84397. http://erepository.uonbi.ac.ke/bitstream/handle/11295/105433/Njunge_Enhancement%20Of%20Colonisation%20Of%20Soybean%20Roots%20By%20Arbuscular%20Mycorrhizal%20Fungi%20Using%20Vermicompost%20And%20Biochar.pdf?sequence=1\nFigure 4: Case Study, Increased Soil Organic Carbon with biochar Application\nCitation: Li, S., Ma, Q., & Zhou, C. (2021). Applying biochar under topsoil facilitates soil carbon sequestration: A case study in a dryland agricultural system on the Loess Plateau. Geoderma, 403(115186). https://doi.org/10.1016/j.geoderma.2021.115186\nWorks Cited\nReferences Bista, P., Machado, R., & Pritchett, S. (2019). Biochar Effects on Soil Properties and Wheat Biomass vary with Fertility Management. Agronomy, 9(263). https://doi.org/10.3390/agronomy9100623 Cho, R. (2018, February 21). Can Soil Help Combat Climate Change? State of the Planet. Retrieved February 21, 2022, from https://news.climate.columbia.edu/2018/02/21/can-soil-help-combat-climate-change/ Fuss, S., & Lamb, W. (2018). Negative emissions—Part 2: Costs, potentials and side effects. Environ. Res, 13(063002). https://iopscience.iop.org/article/10.1088/1748-9326/aabf9f Guo, M., He, Z., & Uchimiya, S. M. (Eds.). (2016). Agricultural and Environmental Applications of Biochar: Advances and Barriers. Wiley. Lehmann, J. (2007). A handful of carbon. Nature, 447(447), 143-144. https://www.nature.com/articles/447143a Lehmann, J., Gaunt, J., & Rondon, M. (2006). Bio-char Sequestration in Terrestrial Ecosystems – A Review. Mitig Adapt Strat Glob Change, 11(403-427). https://doi.org/10.1007/s11027-005-9006-5 Levitan, D. (2010, December 9). Refilling the Carbon Sink: Biochar’s Potential and Pitfalls. Yale E360. Retrieved February 20, 2022, from https://e360.yale.edu/features/refilling_the_carbon_sink_biochars_potential_and_pitfalls Li, S., Ma, Q., & Zhou, C. (2021). Applying biochar under topsoil facilitates soil carbon sequestration: A case study in a dryland agricultural system on the Loess Plateau. Geoderma, 403(115186). https://doi.org/10.1016/j.geoderma.2021.115186 Njunge, L. (2012). Enhancement Of Colonisation Of Soybean Roots By Arbuscular Mycorrhizal Fungi Using Vermicompost and Biochar. University of Nairobi, Reg Number: I575/84397, NA. http://erepository.uonbi.ac.ke/bitstream/handle/11295/105433/Njunge_Enhancement%20Of%20Colonisation%20Of%20Soybean%20Roots%20By%20Arbuscular%20Mycorrhizal%20Fungi%20Using%20Vermicompost%20And%20Biochar.pdf?sequence=1 Shiralian, M. (2016, June 14). Biochar offers many environmental benefits. Environmental Science & Engineering Magazine. Retrieved February 20, 2022, from https://esemag.com/hazmat-remediation/biochar/ Sorensen, R., & Lamb, M. (2018). Return on investment from biochar application. Crop, Forage & Turfgrass Management, 4(1), 1-6. https://doi.org/10.2134/cftm2018.02.0008 Verheijen, F., Jeffery, S., & Bastos, A. (2010). Biochar application to soils. A critical scientific review of effects on soil properties, processes, and functions. EUR, 24099(162), NA. https://www.academia.edu/download/9425519/biochar.pdf Yaashikaa, P., Kumar, P., & Varjani, S. (2020). A critical review on the biochar production techniques, characterization, stability and applications for circular bioeconomy. Biotechnology Reports, 28(e00570), . ElSEVIER. https://doi.org/10.1016/j.btre.2020.e00570\n\n\n\n",
    "preview": {},
    "last_modified": "2022-03-08T22:05:44-08:00",
    "input_file": "biochar-for-carbon-sequestration.knit.md"
  },
  {
    "path": "posts/2022-03-08-biodiversity-from-space-remote-sensing-for-biodiversity-monitoring/",
    "title": "Biodiversity from Space: Remote Sensing for Biodiversity Monitoring",
    "description": "How can remote sensing and earth observations be used for biodiversity assessments as an aspect of monitoring ecosystem health?",
    "author": [
      {
        "name": "Sophia Leiker",
        "url": {}
      }
    ],
    "date": "2022-03-08",
    "categories": [],
    "contents": "\nNational Park ServiceTitle: Biodiversity from Space: How can remote sensing and earth observations be used for biodiversity assessments as an aspect of monitoring ecosystem health?\nAuthor(s): Sophia S. Leiker\nAffiliations: Masters Student of Conservation Planning, Bren School of Environmental Science and Management, University of California Santa Barbara, US\n1. Introduction\nThe continuous global loss of biodiversity has driven the development of methodologies for monitoring biodiversity at large spatial scales. Traditional in-situ biodiversity assessments are often spatially limited, with high costs required to gather sufficient data for analysis (Wang and Garmon 2019). Remote sensing provides the opportunity to advance these assessments through the use of rapidly evolving technologies such as high-resolution hyperspectral satellite sensors, airborne laser scanning (LiDAR), and drone assessments (iVihervaara and Auvinen 2017). The use of these tools allows for large area characterization of biodiversity in a “systematic, repeatable, and spatially exhaustive manner” (Duro, Coops and Wulder 2007). With biodiversity loss recognized as a serious threat to human-wellbeing an ecosystem functioning (Vihervaara, et al. 2017), accurate biodiversity monitoring is crucial to include in policy making at the local, national and international levels. Synchronization of remote sensing science and conservation biology is essential for making well informed environmental management decisions (Pettorelli, Wegmann, et al. 2016). With studies estimating that we are losing from 11,000-58,000 species annually (Pettorelli, Wegmann, et al. 2016), there is the need to assess the current state of the to identify and support coordinated efforts to rapidly scale up. This report will assess how remote sensing can be used for biodiversity assessments by 1) outlining the approaches currently used, 2) identifying the limitations of these methods, and 3) briefly discussing opportunities and future directions.\n2. Approaches Currently Used\nBiodiversity is a multifaced concept with many layers of complexity. Due to this, approaches used vary with spatial scale, dimensionality, validation techniques, and use of proxy indicators (Storms and Estes 1993). In general, remote sensing methods to measure biodiversity are broken down into three major categories: a) direct mapping of individual organisms, b) species distribution modeling with habitat mapping as a proxy for biodiversity, c) the use of biodiversity indices/indicators. Direct Mapping employs high resolution imagery and machine learning techniques such as digital ocular sampling or image detection and classification to detect species assemblages, or, in some cases, individuals within a population. This analysis can provide valuable information about diversity patters and is most often paired with in-situ field data which can be used for model validation (Turner, et al. 2003). Model success is often driven by data availability and organism characteristics as some species are clearly distinguishable, while others may be more difficult to differentiate from background noise. Studies have shown success in mapping species distribution for terrestrial plant biodiversity using plant functional traits to determine trends in seasonal patterns (Wang and Garmon 2019). Through the use of LiDAR and imaging spectroscopy, this method has also been successful in studying leaf traits and canopy structure as proxies for regional biodiversity (Stein, Katharina and Holger 2014). As plant traits affect light absorption/scattering, this method can be used to distinguish differences in optical properties of plants throughout a landscape by extracting their spectral signatures. Species distribution modeling can be used for habitat mapping and predictions of species distribution based on habitat requirements (Nagendra 2010). These maps can be used to provide information on distributions of a large number of species within a variety of habitat types, and overlayed or used for ensemble modeling to carry out biodiversity assessments. These indirect methods often assess habitat heterogeneity as heterogeneity has been regarded “as one of the most important factors governing species richness and has been predicted to have a positive relationship with biodiversity” (Stein, Katharina and Holger 2014). High heterogeneity can provide increased niche spaces for species coexistence, persistence, and diversification (Stein, Katharina and Holger 2014). Habitat mapping can assess climate and habitat structure, geology, and topography, and integrate this information with regional models (such as the National Gap Analysis Program) or local models to estimate biodiversity (Stein, Katharina and Holger 2014). Biodiversity indices and aligned algorithms such as the biodiversity variable (Pettorelli, Wegmann, et al. 2016) can be used to standardize biodiversity measures. National biodiversity state indicators such as “Essential Biodiversity Variables” developed and employed by GEO BON (Group on Earth Observations Biodiversity Observation Network) include 22 candidate variables to be modeled (Vihervaara, et al. 2017). These are model-based integrations of remote sensing & in-situ observations that enable dynamic updates and transparency at low cost. Some of the indicators that can be used to assess and report on progress towards global biodiversity goals and targets include species habitat index, biodiversity habitat index, local biodiversity intactness index, and rate of invasive alien species spread indicator. Vegetation indices can also be employed to assess vegetation community composition and used as proxies for biodiversity (Wang and Garmon 2019).\n3. Limitations\nWith many benefits aligned with remote sensing for biodiversity monitoring, there are also limitations which must be overcome for rapid scaling of standardized approaches. First, while many satellite products freely available, there has been an increasing trend in utilizing private pay-to-view imagery for biodiversity assessments due to their high resolution (Pettorelli, Laurance, et al. 2014). This can prevent replicability and reduce opportunities for coordinated efforts to scale up. Additionally, the requirement of significant in-situ data to validate and test model accuracy can limit overall model confidence. To overcome this, there is a need for increased open data access and data sharing for model training. For biodiversity monitoring there are drawbacks to each of the approaches. First, the resolution of satellite data is often too course to pick up individual species, as spectral reflectance is bounded by pixel size (often 30m for Landsat or 10m for Sentinel data). For this reason, these assessments are more beneficial in vegetation assessments with large crown sizes such as canopy cover in forests but are less informative with spatially small organisms (Stein, Katharina and Holger 2014). Direct mapping is applicable over smaller extents, and can be useful for “limited purpose of indicating areas with higher levels of species diversity” (Nagendra 2010), but often, large biodiversity studies lack the resources to obtain and process the immense amount of data that is needed for modeling at a global scale. Second, while habitat mapping is good at developing proxy biodiversity assessments, it also has many limitations. First these estimates map potential rather than real species distributions and may not be able to determine rare species abundance which is a key component of understanding biodiversity (Stein, Katharina and Holger 2014). Similar to species mapping, habitat mapping is limited by the resolution of the imagery being used which means that detailed information can be lost when using course resolution satellite products (Stein, Katharina and Holger 2014). Third, there is a lack of consistency in the development and implementation of biodiversity variables. Without standards set, biodiversity indices and algorithms are being developed without any coordination, causing overlap and conflicting biodiversity outputs depending on the scale the initial index was developed at. Additionally, there is hesitation in employing biodiversity indicators without understanding the deeper relationships in the landscape, “Links between biodiversity indicators and the pressures affecting them are frequently unclear as links can be obscured by environmental change, data limitations, food web dynamics, or the cumulative effects of multiple pressures” (Gollop, et al. 2019).\n4. Opportunities/Future Directions\nAs more satellites are launched increasing both spatial and temporal resolution of earth observation data, there are many avenues to further explore the integrating remote sensing into biodiversity monitoring. Based on the limitations due to pixel resolution mentioned above, there is additional work being done on developing approaches for mapping dominant species or vegetation types based on spectral mixture analysis (Dudley, et al. 2015). This approach makes the assumption that a spectral signature is a combination of “end members”, and individual species/relative amounts of species within a mixed pixel can be “identified by applying endmembers that have been obtained from field measures… or simulated radiative transfer models” (Stein, Katharina and Holger 2014). This can provide information to map “indicator species” and support the derivation of biodiversity metrics. Additionally, the integration of LiDAR in these assessments has shown promise. There is currently being work being done to improve assessment of vertical vegetation structures as this is “a key component of habitat quality for many species” (Pettorelli, Laurance, et al. 2014) (Frederic and Hansen 2012). Finally, large scale assessments are building on an idea that “spectral diversity”/“optical diversity” can be used as proxies for species diversity, functional diversity, and genetic diversity (Stein, Katharina and Holger 2014). This hypothesis is rooted in the theory that combining metrics based on variation in vegetation indices, metrics based on spectral entropy, and metrics based of spectral species can be used to infer biodiversity through an assessment of the mean and variance associated with each (Stein, Katharina and Holger 2014). This connects to work being done to test out the Spectral Variability Hypothesis which postulates that “species richness will be positively related to any objective measure (e.g. standard deviation) of the variation in the spectral characteristics of a remotely sensed image” (Palmer, et al. 1999). The Spectral Variability Hypothesis has been tested with conclusions illustrating that overall performance is dependent on several factors, including “the instrument characteristics (spectral, spatial and temporal resolution), the type of vegetation investigated, and the metrics derived from remotely sensed information to estimate spectral heterogeneity” (Rocchini, Luque and Pettorelli 2018). Even with this variation, studies that employed multispectral high-resolution data (3m) have shown success in using this method (Rocchini, Chiarucci and Loise 2004).\n##5. Conclusions\nCapacity building and cross disciplinary collaboration is critical for the success of widespread biodiversity monitoring efforts. There is a dire need to establish more standardized frameworks at a variety of scales, that, with the help of remote sensing, can be applied at any place across the globe. While traditional monitoring methods are still necessary to overcome current methodological limitations, we must expand biodiversity monitoring through remote sensing as a critical tool in our toolbox to preserve ecosystem health across our globe. Whether the approaches used are for direct species identification, habitat modeling, or the development of biodiversity indicators, there much be a joint effort from remote sensing specialists, biologists, and ecologists alike, to expand the limits of where this field can take us.\nBibliography\nDudley, Kenneth, Phillip Dennison, Keely Roth, Dar Roberts, and A.R Coats. 2015. “A multi-temporal spectral library approach for mapping vegetation species across spatial and temporal phenological gradients.” Remote Sensing of Environment 167 (121-134). Duro, Dennis, Nicholas Coops, and Muchael Wulder. 2007. “Development of a large area biodiversity monitoring system driven by remote sensing.” Progress in Physical Geography 31 (3): 235-260. Frederic, Achard, and Matthew Hansen. 2012. Global Forest Monitoring From Earth Observation. Taylor & Francis. Gollop, Abigail, Ian Mitchell, Christina Vina-Herbon, and Jacob Bedford. 2019. “From Science to Evidence – How Biodiversity Indicators Can Be Used for Effective Marine Conservation Policy and Management.” Fronteirs of Marine Science. Nagendra, H. 2010. “Using Remote Sensing to Assess biodiversity.” International Journal of Remote Sensing 22 (12): 2377-2400. Palmer, Michael, Thomas Wohlgemuth, Peter Earls, Jose Arevaleo, and Steven Thomson. 1999. “Opportunities for Long-Term Ecological Research at the Tallgrass Prairie Preserve, Oklahoma.” Cooperation in Long Term Ecological Research in Central and Eastern Europe. ILTER Regional Workshop. Budapest, Hungary. Corvallis, OR: Oregon State University. 123-128. Pettorelli, Nathalie, Martin Wegmann, Andrew Skidmore, Mucher Sander, and Terence Dawson. 2016. “Framing the concept of satellite remote sensing essential biodiversity variables: challenges and future directions.” Remote Sensing in Ecology and Conservation 2 (3): 122-131. Pettorelli, Nathalie, William Laurance, Timothy O’Brian, and Martin Wegmann. 2014. “Satellite remote sensing for applied ecologists: opportunities and challenges.” Journal of Applied Ecology 51 (4). Rocchini, Duccio, Alessandro Chiarucci, and Steven Loiselle. 2004. “Testing the spectral variation hypothesis by using satellite multispectral images.” Acta Oecologica 26 (2): 117-120. Rocchini, Duccio, Sandra Luque, and Nathalie Pettorelli. 2018. “Measuring β-diversity by remote sensing: A challenge for biodiversity monitoring.” Ecology and Evolution 9 (8): 1787-1798. Stein, A, Gerstner Katharina, and Kreft Holger. 2014. \"“Environmental heterogeneity as a universal driver of species richness across taxa, biomes and spatial scales.” Ecology 17 (7): 866-880. Storms, D, and J Estes. 1993. “A remote sensing research agenda for mapping and monitoring biodiversity.” International Journal on Remote Sensing 14 (10). Turner, Woody, Sacha Spector, Ned Gariner, and Matthew Fladeland. 2003. “Remote sensing for biodiversity science and conservation.” Trends in Ecology and Evolution 18 (6): 306-314. Vihervaara, P, Ari-Pekka Auvinen, Laura Mononen, and Markus Torma. 2017. “How Essential Biodiversity Variables and remote sensing can help national biodiversity monitoring.” Global Ecology and Conservation 10: 43-59. Wang, Ran, and John Garmon. 2019. “Remote sensing of terrestrial plant biodiversity.” Remote Sensing of the Environment 231.\n\n\n\n",
    "preview": {},
    "last_modified": "2022-03-08T22:03:17-08:00",
    "input_file": "biodiversity-from-space-remote-sensing-for-biodiversity-monitoring.knit.md"
  },
  {
    "path": "posts/2022-02-18-binary-logistic-regression/",
    "title": "Binary Logistic Regression",
    "description": "Binary logistic regression to test feasibility of using variables plant height (height), canopy length (length), canopy width (width), and number of green leaves (green_lvs) to classify whether a palmetto is species Serenoa repens or Sabal etonia.",
    "author": [
      {
        "name": "Sophia Leiker",
        "url": {}
      }
    ],
    "date": "2022-02-18",
    "categories": [],
    "contents": "\n\n\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)\n\nlibrary(tidyverse)\nlibrary(here)\nlibrary(janitor)\nlibrary(patchwork)\nlibrary(cowplot)\nlibrary(GGally)\nlibrary(broom)\nlibrary(jtools)\nlibrary(caret)\nlibrary(AICcmodavg)\nlibrary(ggbeeswarm)\nlibrary(stargazer)\nlibrary(kableExtra)\nlibrary(modelsummary)\n\n\n\n1. Introduction\nThis report will employ binary logistic regression to test feasibility of using variables plant height (height), canopy length (length), canopy width (width), and number of green leaves (green_lvs) to classify whether a palmetto is species Serenoa repens or Sabal etonia.\nThe analysis will be performed twice, and will use cross validation to compare two models:\nLog odds of plant type using plant height, canopy length, canopy width and green leaves as predictor variable.\nLog odds of plant type using plant height, canopy width and green leaves (i.e., drop canopy length for this model)\nData Source: The data used comes from: Abrahamson, W.G. 2019. Survival, growth and biomass estimates of two dominant palmetto species of south-central Florida from 1981 - 2017, ongoing at 5-year intervals ver 1. Environmental Data Initiative and metadata, including methods used for data collection can be found here EDI Data Portal. The first dataset, palmetto_data, contains survival and growth data across multiple years, habitats and experimental treatments. The second dataset, seedlings_data, follows the fate of marked putative palmetto seedlings in the field to assess survivorship and growth. The final dataset, harvested_palmetto_data, contains size data and estimated dry mass (biomass in grams) of 33 destructively harvested palmetto plants (17 S. repens and 16 S. etonia) of varying sizes and across habitats.\n\n\n# Reading in the data\npalmetto <- read_csv(here(\"_posts\", \"2022-02-18-binary-logistic-regression\", \"data\", \"palmetto.csv\")) %>% \n  clean_names()\n\n\n\n2. Data Exploration and Visualization\nExploring differences in height, canopy length, canopy width, and green leaves for the two species\nheight = maximum height 1981-2017 [cm]\nlength = widest length of the canopy 1981-2017 [cm]\nwidth = widest width of the canopy perpendicular to the canopy length 1981-2017 [cm]\ngreen_lvs = count of green leaves 1981-2017 [dimensionless]\nAssessing what predictor variables might be best used for classification\nspecies column: 1 = Serenoa repens, 2 = Sabal etonia\nA. Cleaning up the data\nRename to easily identify Serenoa repens to Sabal etonia\nSelecting only the columns of interest\n\n\npalmetto_clean <- palmetto %>% \n  select(\"species\", \"height\", \"length\", \"width\", \"green_lvs\")\n\npalmetto_clean$species[palmetto_clean$species == 1] <- \"repens\"\npalmetto_clean$species[palmetto_clean$species == 2] <- \"etonia\"\n\n\n\n\n\n#Evaluating via ggpairs, eval = FALSE after visually assessing trends\npalmetto_clean %>% \n  select(species, height:green_lvs) %>% \n  ggpairs(aes(color=species))\n\n#seems like there are differences in green_lvs\n#slight difference in height and length\n#not much difference in width\n\n\n\nB. Visualizing the Data\nExploring differences in height, canopy length, canopy width, and green leaves for the two species\nWorking to determine which predictor variables are more likely to help classify species correctly\n\n\n#Plotting Width\nplot1 <- ggplot(data = palmetto_clean, aes(x = species, y = width)) +\n  geom_beeswarm(cex = 2, aes(color = species)) +\n  theme_minimal() +\n  labs(x = \"Species\", y = \"Width (cm)\", title = \"Canopy  Width S. repens, S. etonia\", subtitle = \"Data from: Abrahamson, W.G. 2019\") +\n  guides(fill = guide_legend(title = \"Species\")) +\n  geom_boxplot(fill = NA, width = 0.4, outlier.color = NA) +\n    theme(axis.ticks.x = element_blank(),\n        axis.text.x = element_blank()) +\n   scale_color_manual(values = c(\"steelblue1\", \"tan1\")) +\n  theme(legend.position = c(0.9, 0.75)) +\n    theme(legend.background = element_rect(fill=\"white\", \n                                  size=0, linetype=\"solid\"))\n\n#Plotting Height\nplot2 <- ggplot(data = palmetto_clean, aes(x = species, y = height)) +\n  geom_beeswarm(cex = 2, aes(color = species)) +\n  theme_minimal() +\n  labs(x = \"Species\", y = \"Canopy Height (cm)\", title = \"Canopy Height S. repens, S. etonia\", subtitle = \"Data from: Abrahamson, W.G. 2019\") +\n  guides(fill = guide_legend(title = \"Species\")) +\n  geom_boxplot(fill = NA, width = 0.4, outlier.color = NA) +\n    theme(axis.ticks.x = element_blank(),\n        axis.text.x = element_blank()) +\n   scale_color_manual(values = c(\"steelblue1\", \"tan1\")) +\n  theme(legend.position = c(0.9, 0.80)) +\n  theme(legend.background = element_rect(fill=\"white\", \n                                  size=0, linetype=\"solid\"))\n\n#Plotting Length\nplot3 <- ggplot(data = palmetto_clean, aes(x = species, y = length)) +\n  geom_beeswarm(cex = 2, aes(color = species)) +\n  theme_minimal() +\n  labs(x = \"Species\", y = \"Length (cm)\", title = \"Canopy Length S. repens, S. etonia\", subtitle = \"Data from: Abrahamson, W.G. 2019\") +\n  guides(fill = guide_legend(title = \"Species\")) +\n  geom_boxplot(fill = NA, width = 0.4, outlier.color = NA) +\n  theme(axis.ticks.x = element_blank(),\n        axis.text.x = element_blank()) +\n  scale_color_manual(values = c(\"steelblue1\", \"tan1\")) +\n  theme(legend.position = c(0.9, 0.82)) +\n  theme(legend.background = element_rect(fill=\"white\", \n                                  size=0, linetype=\"solid\"))\n\n\n\nVisualizing Individual Variables Between Species\nResults from this initial assessment will be used to plot final visualizations comparing variables to eachother by species (see Figures 2,3 and 4 for finalized assessments)\n\n\nplot_grid(plot1, plot2, plot3, labels = c(\"A.\", \"B.\", \"C.\"), label_size = 20)\n\n\n\nFigure 1: Spread of individual data points for the variables width, height, and length for Serenoa repend (orange) vs Sabtal etonia (blue). A) Illustrates canopy width as the widest width of the canopy perpendicular to the canopy length 1981-2017 [cm] between the two species, B) Illustrates maximum height 1981-2017 [cm] between the two species. C) Illustrates widest length of the canopy 1981-2017 [cm]. Green leaf spread is analyzed below.The box plots in black indicate the 25th and 75th percentile values of the data spread, the black line indicates the median value.\nTakeaways In general, there seems to be significant overlap in the spread of the width values across the dataset as seen in Figure 1 Part A. Canopy height in Figure 1 Part B illustrates that at the upper and lower ends of the height range, S. repends tends to stand out thus at these points there may be some power in incorporating this variable in analysis. Canopy length has similar trends to canopy width and thus with significant overlap may not provide as much explanatory power in differentiating the two species except at the higher values or when length is around 50cm - 100cm (at these points there seems to be more datapoints for the Serenoa repends (orange))\nVisualizing Variable Relationships (multiple variables)\n\n\nggplot(data = palmetto_clean, aes(x = length, y = width)) +\n  geom_point(aes(color = species)) +\n  theme_minimal() +\n  labs(x = \"Length (cm)\", y = \"Width (cm)\", title = \"Canopy Length and Width for Serenoa repens vs Sabal etonia\", subtitle = \"Data from: Abrahamson, W.G. 2019\") +\n  scale_color_manual(values = c(\"steelblue1\", \"tan1\"))\n\n\n\n\nFigure 2: Relationship between canopy length and canopy width for Serenoa repend (orange) vs Sabtal etonia (blue).\n\n\nggplot(data = palmetto_clean, aes(x = height, y = green_lvs)) +\n  geom_point(aes(color = species)) +\n  theme_minimal() +\n  labs(x = \"Height (cm)\", y = \"Green Leaves (count)\", title = \"Canopy Height and Green Leaves Count for Serenoa repens vs Sabal etonia\", subtitle = \"Data from: Abrahamson, W.G. 2019\") +\n  scale_color_manual(values = c(\"steelblue1\", \"tan1\"))\n\n\n\n\nFigure 3: Relationship between canopy height and green leaves for Serenoa repend (orange) vs Sabtal etonia (blue).\n\n\nggplot(data = palmetto_clean, aes(x = length, y = green_lvs)) +\n  geom_point(aes(color = species)) +\n  theme_minimal() +\n  labs(x = \"Length (cm)\", y = \"Green Leaves (count)\", title = \"Length and Green Leaves Count for Serenoa repens vs Sabal etonia\", subtitle = \"Data from: Abrahamson, W.G. 2019\") +\n  scale_color_manual(values = c(\"steelblue1\", \"tan1\"))\n\n\n\n\nFigure 4: Relationship between canopy length and green leaves for Serenoa repend (orange) vs Sabtal etonia (blue).\nOverall Takeaways: The variables that are most likely to help classify species seem to be first and most clearly, the leaf count, followed by height and then length, and lastly width. There seems to be significant overlap in canopy width which indicates that is may not be an ideal candidate to help separate out species. Canopy height and length differ on the upper end of the scale (higher values), but have significant overlap near lower values. Leaf count visually reflects the largest difference between the two species and thus could be the most likely to help classify Serenoa repend vs Sabtal etonia (blue) most clearly.\n3. Binary Logistic Regression\nConverting to factors\nEstablishing the factor levels, due to the result below it can be determined that “etonia” will be 0, “repens” will be 1\n\n\n#Converting to factor\n\npalmetto_clean2<- palmetto %>% \n  select(\"species\", \"height\", \"length\", \"width\", \"green_lvs\") %>% \n  mutate(species = case_when(species == 1 ~ \"repens\", species == 2 ~ \"etonia\")) %>% \n  mutate(species = as.factor(species)) %>% \n  drop_na()\n\n\nlevels(palmetto_clean2$species)\n\n\n[1] \"etonia\" \"repens\"\n\nA. Log odds of plant type using plant height, canopy length, canopy width and green leaves as predictor variables\n\n\n#establishing the relationships\nf1 <- species ~ height + length + width + green_lvs\n\n#Generalized Linear Model\n\nspecies_blr1 <- glm(formula = f1,\n                    data = palmetto_clean2,\n                    family = \"binomial\")\n\n\n\nLet’s look at the results\nBased on the summary output, all 4 of the variables have low p values which may indicate that they may be significant\nInterpretation of some coefficients: since green leaves is positive, we could estimate that for every 1.9 additional green leaves it makes it a little more likely that it is a repens.\n\n\n\n#species_blr1\n\nsummary(species_blr1) \n\n\n\nCall:\nglm(formula = f1, family = \"binomial\", data = palmetto_clean2)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-4.7828  -0.2681  -0.0054   0.1725   3.3964  \n\nCoefficients:\n             Estimate Std. Error z value Pr(>|z|)    \n(Intercept) -3.226685   0.142071  -22.71   <2e-16 ***\nheight       0.029217   0.002306   12.67   <2e-16 ***\nlength      -0.045823   0.001866  -24.56   <2e-16 ***\nwidth       -0.039443   0.002100  -18.78   <2e-16 ***\ngreen_lvs    1.908475   0.038863   49.11   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 17005.5  on 12266  degrees of freedom\nResidual deviance:  5184.6  on 12262  degrees of freedom\nAIC: 5194.6\n\nNumber of Fisher Scoring iterations: 7\n\nblr1_tidy <- broom::tidy(species_blr1)\n\n\n\nThese are coefficients for the log-linear model (e.g. these are coefficients for the predictor variables that relate to the log odds of the “Serenoa repend” outcome).\nIt took 7 iterations to reach this model outcome\nB. Log odds of plant type using plant height, canopy width and green leaves\n\n\nf2 <- species ~ height + width + green_lvs\n\n#Generalized Linear Model\n\nspecies_blr2 <- glm(formula = f2,\n                    data = palmetto_clean2,\n                    family = \"binomial\")\n\n\n\nLet’s look at the results\nBased on the summary output, width and green leaves have low p values which may indicate that they may be significant\nHeight has a higher p values which may indicate it is not as significant for this model\n\n\n\n#species_blr2\n\nsummary(species_blr2) \n\n\n\nCall:\nglm(formula = f2, family = \"binomial\", data = palmetto_clean2)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-4.7113  -0.3404  -0.0112   0.2167   3.4455  \n\nCoefficients:\n             Estimate Std. Error z value Pr(>|z|)    \n(Intercept) -3.767722   0.135314 -27.844   <2e-16 ***\nheight       0.002950   0.001881   1.568    0.117    \nwidth       -0.069019   0.001785 -38.661   <2e-16 ***\ngreen_lvs    1.884815   0.036127  52.172   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 17005.5  on 12266  degrees of freedom\nResidual deviance:  5979.5  on 12263  degrees of freedom\nAIC: 5987.5\n\nNumber of Fisher Scoring iterations: 7\n\nblr2_tidy <- broom::tidy(species_blr2)\n\n\n\n\n\nblr2_fitted <- species_blr2 %>% \n  broom::augment(type.predict = \"response\")\n\n\n\nC. Comparing Models using AICc\n\n\nAIC_assessment <- AICcmodavg::aictab(list(species_blr1, species_blr2))\n\n\n\nAICc for Model 1 (plant height, canopy length, canopy width and green leaves) is 5194.57\nAICc for Model 2 (plant height, canopy width and green leaves) is 5987.48\nAccording to this AICc calculation, Model 1 has a lower value for AICc so just based on the AICc, we might anticipate that model 1 will be the better model.\nD. Comparing Model 1 and Model 2 using Ten-fold cross validation\n\n\nset.seed(123) \ntr_ctrl <- trainControl(method = \"repeatedcv\", number = 10, repeats = 10)\n \n# Train the model\n#Formula f1, data frame, method is the generalized linear model\nmodel1_height_length_width_green_lvs <- train(f1, data = palmetto_clean2, \n               method = \"glm\", family = 'binomial',\n               trControl = tr_ctrl)\n#summary(model1_height_length_width_green_lvs)\n#model 1  accuracy 0.9169231  kappa 0.8338335\n \nmodel2_height_width_green_lvs <- train(f2, data = palmetto_clean2, \n               method = \"glm\", family = 'binomial',\n               trControl = tr_ctrl)\n#summary(model2_height_width_green_lvs)\n#model 2   accuracy 0.8988022  kappa 0.7975858\n\n#Since the accuracy of model 1 is higher, we may be able to state that model 1 is the better performing model\n\n\n\nTakeaways : Based on the accuracy results of the corss validation, Model 1 (height, length, width, green_lvs) has a higher accuracy than Model 2 (height, width, green_lvs) and therefore it can be said that model 1 performs better at classification. This aligns with the AICc assessment carried out above.\nFor this reason, Model 1 will be selected to run on the entire dataset.\n4. Running Model 1 (Variables included: height, length, width, green_lvs) on entire dataset\n\n\nfinal_model <- glm(formula = f1,\n                    data = palmetto_clean2,\n                    family = \"binomial\")\n\n\n\n\n\nfinal_table <- tidy(final_model) %>% \n  mutate(p.value = case_when(p.value <= 0.0001 ~ \"< 0.0001\")) %>% \n  rename(\"Term\" = \"term\")\n\nfinal_table %>% \n  kbl(digits = 3, caption = \"Table 1: Binary Logistic Regression Model Outputs Showing the Variables, Coefficients, Standard Errors\", col.names = c(\"Term\", \"Estimate\", \"Standard Error\", \"Statistic\", \"P Value\")) %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = F)\n\n\n\nTable 1: Table 1: Binary Logistic Regression Model Outputs Showing the Variables, Coefficients, Standard Errors\n\n\nTerm\n\n\nEstimate\n\n\nStandard Error\n\n\nStatistic\n\n\nP Value\n\n\n(Intercept)\n\n\n-3.227\n\n\n0.142\n\n\n-22.712\n\n\n< 0.0001\n\n\nheight\n\n\n0.029\n\n\n0.002\n\n\n12.670\n\n\n< 0.0001\n\n\nlength\n\n\n-0.046\n\n\n0.002\n\n\n-24.556\n\n\n< 0.0001\n\n\nwidth\n\n\n-0.039\n\n\n0.002\n\n\n-18.782\n\n\n< 0.0001\n\n\ngreen_lvs\n\n\n1.908\n\n\n0.039\n\n\n49.107\n\n\n< 0.0001\n\n\nFinal Model Equation: \\[\n\\begin{aligned}\n\\log\\left[ \\frac { \\widehat{P( \\operatorname{species} = \\operatorname{repens} )} }{ 1 - \\widehat{P( \\operatorname{species} = \\operatorname{repens} )} } \\right] &= -3.23 + 0.03(\\operatorname{height}) - 0.05(\\operatorname{length}) - 0.04(\\operatorname{width})\\ + \\\\\n&\\quad 1.91(\\operatorname{green\\_lvs})\n\\end{aligned}\n\\]\n5. Model Evaluation\nAnalyzing how successfully this model would “classify” a plant as the correct species, using a 50% cutoff\n\n\nblr_fitted <- final_model %>% \n  broom::augment(type.predict = \"response\")\n\n#That shows us the probability (in the `.fitted` column) of the plant being a Serenoa repend on the 4 variables included in this model.\n\n\n\n\n\n#creating a function\npred_acc <- function(x, y) {\n  accurate <- ifelse(x == y, 1, 0)\n  return(accurate)\n}\n\n#final_model Serenoa repend (orange) vs Sabtal etonia (blue)\n#Adelie will be 0, Chinstrap will be 1)\n#\"etonia\" will be 0, \"repens\" will be 1\n\nmodel_success <- palmetto_clean2 %>% \n  mutate(predict_repens = predict(final_model, palmetto_clean2, type = \"response\")) %>% \n  mutate(predicted = ifelse(predict_repens >= 0.50, \"repens\", \"etonia\")) %>%\n  mutate(accurate = pred_acc(species, predicted)) %>% \n  mutate(correct =  case_when(species == predicted ~ \"Correct\",\n                              TRUE ~ \"Incorrect\"))\n\ntable2 <- model_success %>%\n  group_by(species) %>% \n  summarize(total_accurate = sum(accurate),\n            total_inaccurate = n() - sum(accurate),\n            model_success = mean(accurate)*100)\n\ntable2 %>% \n  kbl(digits = 2, caption = \"Table 2: Model Accuracy by Species\", col.names = c(\"Species\", \"Total Accurate\", \"Total Inaccurate\", \"% Correctly Classified\")) %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = F)\n\n\n\nTable 2: Table 2: Model Accuracy by Species\n\n\nSpecies\n\n\nTotal Accurate\n\n\nTotal Inaccurate\n\n\n% Correctly Classified\n\n\netonia\n\n\n5701\n\n\n454\n\n\n92.62\n\n\nrepens\n\n\n5548\n\n\n564\n\n\n90.77\n\n\nCONCLUSIONS: Based on the model success metrics, one can see that on average the model was predicting correctly about 90% of the time. The model was slightly more accurate when predicting Sabtal etonia compared to Serenoa repend, but the difference was only around 2%.\n6. Data Citation\nData source: Abrahamson, W.G. 2019. Survival, growth and biomass estimates of two dominant palmetto species of south-central Florida from 1981 - 2017, ongoing at 5-year intervals ver 1. Environmental Data Initiative. https://doi.org/10.6073/pasta/f2f96ec76fbbd4b9db431c79a770c4d5\nEND TASK\n\n\n\n",
    "preview": "posts/2022-02-18-binary-logistic-regression/binary-logistic-regression_files/figure-html5/unnamed-chunk-5-1.png",
    "last_modified": "2022-02-18T17:28:02-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-02-18-nonlinear-least-squares/",
    "title": "Nonlinear Least Squares",
    "description": "Emploing non linear least squares to estimate parameters of a length to weight model for lizard populations in New Mexico..",
    "author": [
      {
        "name": "Sophia Leiker",
        "url": {}
      }
    ],
    "date": "2022-02-18",
    "categories": [],
    "contents": "\n\n\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)\n\nlibrary(tidyverse)\nlibrary(here)\nlibrary(janitor)\nlibrary(lubridate)\nlibrary(patchwork)\nlibrary(cowplot)\nlibrary(broom)\nlibrary(jtools)\nlibrary(caret)\nlibrary(kableExtra)\nlibrary(modelr)\n\n\n\nIntroduction\nThis report will employ non linear least squares to estimate parameters of a length to weight model for lizard populations in New Mexico. To do this the snout length to weight model will be used.\nData Source: The data used comes from: Lightfoot, D. and W.G. Whitford. 2020. Lizard pitfall trap data from 11 NPP study locations at the Jornada Basin LTER site, 1989-2006 ver 37. Environmental Data Initiative. and metadata, including raw data and methods used for data collection can be found here EDI Data Portal.\nThis data package contains data on lizards sampled by pitfall traps located at 11 consumer plots at Jornada Basin LTER site from 1989-2006. Lizards were captured in pitfall traps at the 11 LTER II/III consumer plots (a subset of NPP plots) quarterly for 2 weeks per quarter. Variables measured include species, sex, recapture status, snout-vent length, total length, weight, and whether tail is broken or whole.\n\n\n# Reading in the data\npalmetto <- read_csv(here(\"_posts\",\"2022-02-18-nonlinear-least-squares\", \"data\", \"lizard.csv\")) %>% \n  clean_names() %>% \n  drop_na() \n  \n#palmetto naming convention was wrong, too far into the code to change when this was realized\n\n\n\n1. Fitting Snout Length to Weight Model\nEquation \\[W = a(SVL)^b\\]\nWhere W is the Body weight (g), SVL is snout to vent length (mm).\na and b are parameters which need to be fitted\nA. Log Transform of data & Running Guess Model\n\n\n# Since the my_guess_model has things in logs, need to log transform to create new columns\npalmetto_log <- palmetto %>% \n  mutate(log_weight = log(weight)) %>% \n  mutate(log_length = log(sv_length))\n\n\n\nRunning linear model\n\n\nmy_guess_model <- lm(log_weight ~ log_length, data = palmetto_log) \n\n\n\nB. Supplying NLS Start list with regression coefficients\nPulling out the coefficients from my_guess_model\nUsing coefficients function\n\n\n\ncoef <- coefficients(my_guess_model)\n\n#Cleaning up the model so I can pull out the coefficients easier  my_guess_model_clean <- tidy(my_guess_model) \n\n\n\nCoefficient Output\nThe intercept of my_guess_model is -8.475\nThe log_length of my_guess_model is 2.537\n\nCreating a function for the equation listed - Inputs are a, sv_length, b (a and b are coefficients)\n\n\nweight_function<-function(a,sv_length,b){\n weight= a*(sv_length)^b\nreturn(weight)\n}\n\n\n\n2. Final Model: Female and Male Spcies by Color\nUsing nls and feeding in our coefficients as a starting off point\n\n\npalmetto_nls <- nls(weight ~ weight_function(a,sv_length,b),\n                    data = palmetto,\n                    start = list(b = coef[2],\n                                 a = exp(coef[1])))\n\n#Cleaning up to create nice output\npalmetto_nls_tidy <- tidy(palmetto_nls)\n\n\n\n\n\n#Making a table with outputs\npalmetto_nls_tidy %>% mutate(p.value = case_when(p.value < 0.001 ~ \"<0.001\")) %>% \n  kable(col.names = c(\"Term\", \"Coefficient\", \"Standard Error\", \"Statistic\", \"P Value\"), digits = 4, caption = \"Table 1: NLS Model Results\") %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\")) %>% \n  kable_styling(full_width = FALSE)\n\n\n\nTable 1: Table 1: NLS Model Results\n\n\nTerm\n\n\nCoefficient\n\n\nStandard Error\n\n\nStatistic\n\n\nP Value\n\n\nb\n\n\n2.4532\n\n\n0.027\n\n\n90.9300\n\n\n<0.001\n\n\na\n\n\n0.0003\n\n\n0.000\n\n\n8.5384\n\n\n<0.001\n\n\n\n\n#augmenting predictions to the actual dataset \n\npalmetto_augment <- palmetto_nls %>% \n  broom::augment()\n\n\n\n\n\n#Plotting female and male lizards separated by color\npalmetto3 <- palmetto\n\npalmetto3$sex[palmetto3$sex == \"M\"] <- \"Male\"\npalmetto3$sex[palmetto3$sex == \"F\"] <- \"Female\"\n  \n\nggplot() +\n  geom_point(data = palmetto3, aes(x=sv_length, y = weight, color = sex)) +\n  labs(title = \"NLS Model Prediction Results for Snout to vent length (mm) vs Weight (g)\", \n       subtitle = \"Data From: Lightfoot, D. and W.G. Whitford. 2020\",\n       x = \"Snout to vent length (mm)\", y = \"Weight (g)\") +\n  theme_minimal() +\n  geom_line(data = palmetto_augment, aes(\n            x = sv_length,\n            y = .fitted,\n            color = \"Model Predictions\"),\n            size = 0.5) +\n  theme(legend.title = element_blank()) +\n  scale_color_manual(values = c(\"seagreen3\", \"mediumblue\", \"mediumvioletred\"))\n\n\n\n\nFigure 1: NLS Model Prediction Results for Snout to vent length (mm) vs Weight (g) with colors representing Male (M) and female (F) lizards. The points represent individual data points from the dataset, the purple line represents the model predictions.\n\n\n#Calculating RMSE\n\npalmetto_rmse <- rmse(palmetto_nls, data = palmetto)\n\n\n\nRMSE The RMSE for the NLS Model run on all the points is 2.791\n3. Filtering for male Western Whiptail lizard (Cnemidophorus tigrisatus)\nFiltering for variables of interest, transforming to log weight and sv_length\nFit NLS Model\n\n\nwhiptail <- palmetto %>% \n  filter(spp == \"CNTI\") %>% \n  filter(sex == \"M\") %>% \n  mutate(log_weight = log(weight)) %>% \n  mutate(log_length = log(sv_length)) %>% \n  drop_na()\n\n\n\nA. Running Linear Model\n\n\nwhiptail_model <- lm(log_weight ~ log_length, data = whiptail)\n\n\n\nB. Supplying NLS Start list with regression coefficients\nPulling out the coefficients from my_guess_model\nUsing coefficients function\n\n\n\ncoef_whiptail <- coefficients(whiptail_model)\n\n#Cleaning up the model so I can pull out the coefficients easier  whiptail_model_clean <- tidy(whiptail_model) \n\n\n\nCoefficient Output\nThe intercept of whiptail_model is -9.024\nThe log_length of whiptail_model is 2.698\nC. Final Model\nUsing nls and feeding in our coefficients as a starting off point\nUsing original whiptail dataset\n\n\nwhiptail_nls <- nls(weight ~ weight_function(a,sv_length,b),\n                    data = whiptail,\n                    start = list(b = coef_whiptail[2],\n                                 a = exp(coef_whiptail[1])))\n\n#Cleaning up to create nice output\nwhiptail_nls_tidy <- tidy(whiptail_nls)\n\n\n\n\n\n#Making a table with outputs\nwhiptail_nls_tidy %>%\n  kable(col.names = c(\"Term\", \"Coefficient\", \"Standard Error\", \"Statistic\", \"P Value\"), digits = 4, caption = \"Table 2: NLS Model Results\") %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\")) %>% \n  kable_styling(full_width = FALSE)\n\n\n\nTable 2: Table 2: NLS Model Results\n\n\nTerm\n\n\nCoefficient\n\n\nStandard Error\n\n\nStatistic\n\n\nP Value\n\n\nb\n\n\n2.3683\n\n\n0.1800\n\n\n13.1547\n\n\n0.0000\n\n\na\n\n\n0.0005\n\n\n0.0004\n\n\n1.2397\n\n\n0.2192\n\n\n\n\n#augmenting predictions to the actual dataset \n\nwhiptail_augment <- whiptail_nls %>% \n  broom::augment()\n\n\n\n\n\n#data.frame to combine palmetto_augment with the palmetto data set\nnew_dataframe <- data.frame(palmetto_augment, palmetto) %>% \n  filter(spp == \"CNTI\") %>% \n  filter(sex == \"M\")\n\n\n\n\n\n#Plotting female and male lizards separated by color\n\nggplot() +\n  geom_point(data = whiptail, aes(x=sv_length, y = weight)) +\n  labs(title = \"Male Whiptail NLS Model Predictionsfor Snout to vent length (mm) vs Weight (g)\", \n       subtitle = \"Data From: Lightfoot, D. and W.G. Whitford. 2020\",\n       x = \"Snout to vent length (mm)\", y = \"Weight (g)\") +\n  theme_minimal() +\n  geom_line(data = whiptail_augment, aes(\n            x = sv_length,\n            y = .fitted,\n            color = \"Male Whiptail Model Predictions\"),\n            size = 0.5) +\n  theme(legend.title = element_blank()) +\n  geom_line(data = new_dataframe, aes(\n            x = sv_length,\n            y = .fitted,\n            color = \"Full Dataset Model Predictions\"),\n            size = 0.5) +\n  scale_color_manual(values = c(\"mediumvioletred\", \"forestgreen\"))\n\n\n\n\n\n\n#Calculating RMSE\nwhiptail_rmse <- rmse(whiptail_nls, data = whiptail)\ntotal_rmse <- rmse(palmetto_nls, data = whiptail)\n\n\n\nFigure 2: Male Whiptail NLS Model Prediction Results for Snout to vent length (mm) vs Weight (g). The points represent individual data points from the dataset, the purple line represents the model predictions for weight based on the NLS run on the full dataset, the green line represents the model predictions based on the NLS model trained with just the Male Whiptails. The RMSE for the NLS model trained on the full dataset is 3.562. The RMSE for the NLS Model run on male whiptail points is 3.349. By comparing the RMSE values it can be seen that the RMSE higher for the NLS model trained on the full dataset, thus the model that should be used is the Male Whiptail Model (green line). Visually, this can also be seen in the model prediction lines as the green line seems to better capture the trends in the datapoints.\n4. Data Citation\nLightfoot, D. and W.G. Whitford. 2020. Lizard pitfall trap data from 11 NPP study locations at the Jornada Basin LTER site, 1989-2006 ver 37. Environmental Data Initiative. https://doi.org/10.6073/pasta/4a6e258fb49c31e222ecbbcfd128967f\nEND TASK\n\n\n\n",
    "preview": "posts/2022-02-18-nonlinear-least-squares/nonlinear-least-squares_files/figure-html5/unnamed-chunk-9-1.png",
    "last_modified": "2022-02-18T17:36:13-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-30-the-sharpe-ratio/",
    "title": "Remote Sensing and Biodversity Monitoring",
    "description": "This post will highlight the state of remote sensing as used for monitoring, reporting and verying biodiversity as an ecosystem health metric.",
    "author": [
      {
        "name": "Sophia Leiker",
        "url": {}
      }
    ],
    "date": "2022-01-30",
    "categories": [],
    "contents": "\nAdd some really cool info here\n\n\n\n",
    "preview": {},
    "last_modified": "2022-01-30T23:44:57-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-17-welcome/",
    "title": "Welcome!",
    "description": "Drop by to hear musing, thoughts and refelctions on my excitement as I explore topics related to remote sensing, ecosystem services, nature based solutions, Web3 and decentralized finance to fund ecological restoration.",
    "author": [
      {
        "name": "Sophia Leiker",
        "url": {}
      }
    ],
    "date": "2022-01-17",
    "categories": [],
    "contents": "\nWelcome to my site!\nStick around to hear musing\n\n\n\n",
    "preview": {},
    "last_modified": "2022-01-30T23:40:56-08:00",
    "input_file": {}
  }
]
